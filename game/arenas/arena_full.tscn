[gd_scene load_steps=20 format=3 uid="uid://4hoyldpvbgx7"]

[ext_resource type="PackedScene" path="res://arenas/arena.tscn" id="1"]
[ext_resource type="Script" path="res://scripts/util/event_system/event_label_binder.gd" id="3"]
[ext_resource type="Resource" path="res://player/left_player_health_changed_event.tres" id="4"]
[ext_resource type="PackedScene" path="res://player/player.tscn" id="5"]
[ext_resource type="PackedScene" path="res://card/card_hand.tscn" id="6"]
[ext_resource type="Resource" path="res://player/right_player_input_definition.tres" id="7"]
[ext_resource type="Resource" path="res://player/left_player_input_definition.tres" id="8"]
[ext_resource type="Script" path="res://scripts/player/player_manager.gd" id="9"]
[ext_resource type="Script" path="res://scripts/match/state_machine/match_state_machine.gd" id="10"]
[ext_resource type="Script" path="res://scripts/match/state_machine/match_fighting_state.gd" id="11"]
[ext_resource type="Script" path="res://scripts/util/global_node.gd" id="12"]
[ext_resource type="Script" path="res://scripts/match/state_machine/match_prep_state.gd" id="13"]
[ext_resource type="Resource" path="res://player/right_player_health_changed_event.tres" id="14"]
[ext_resource type="Resource" path="res://player/right_player_currency_changed_event.tres" id="15"]
[ext_resource type="Resource" path="res://player/left_player_currency_changed_event.tres" id="16"]
[ext_resource type="Resource" path="res://player/right_player_points_changed_event.tres" id="17"]
[ext_resource type="Resource" path="res://player/left_player_points_changed_event.tres" id="18"]
[ext_resource type="Resource" path="res://player/left_player_died_event.tres" id="19"]
[ext_resource type="Resource" path="res://player/right_player_died_event.tres" id="20"]

[node name="arena_full" type="Node2D"]

[node name="camera_2d" type="Camera2D" parent="."]
offset = Vector2(960, 540)

[node name="match" type="Node" parent="."]
script = ExtResource("10")

[node name="prep_state" type="Node" parent="match"]
script = ExtResource("13")
label_path = NodePath("../../labels/time_label")
player_manager_path = NodePath("../../players")
timer_path = NodePath("prep_timer")

[node name="prep_timer" type="Timer" parent="match/prep_state"]
wait_time = 10.0
one_shot = true
script = ExtResource("12")
key = "prep_timer"
path = NodePath(".")

[node name="fighting_state" type="Node" parent="match"]
script = ExtResource("11")
label_path = NodePath("../../labels/time_label")
timer_path = NodePath("fighting_timer")

[node name="fighting_timer" type="Timer" parent="match/fighting_state"]
wait_time = 20.0
one_shot = true
script = ExtResource("12")
key = "fighting_timer"
path = NodePath(".")

[node name="arena" parent="." instance=ExtResource("1")]

[node name="cards" type="Node2D" parent="."]

[node name="card_hand_right" parent="cards" instance=ExtResource("6")]
position = Vector2(1571, 1003)

[node name="card_hand_left" parent="cards" instance=ExtResource("6")]
position = Vector2(515, 1002)

[node name="labels" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0

[node name="time_label" type="Label" parent="labels"]
layout_mode = 0
offset_left = 873.0
offset_top = 99.0
offset_right = 1249.0
offset_bottom = 239.0
scale = Vector2(0.5, 0.5)
text = "00:30"

[node name="tutorial_label_left" type="Label" parent="labels"]
layout_mode = 0
offset_left = 10.0
offset_top = 48.0
offset_right = 804.0
offset_bottom = 342.0
scale = Vector2(0.5, 0.5)
text = "W,A,S,D (Move)
A,D (Select CARD)
E (Buy Card)"

[node name="tutorial_label_right" type="Label" parent="labels"]
layout_mode = 0
offset_left = 1441.0
offset_top = 49.0
offset_right = 2331.0
offset_bottom = 343.0
scale = Vector2(0.5, 0.5)
text = "Arrows (Move)
<-, -> (Select CARD)
N (Buy Card)"

[node name="currency_left" type="Label" parent="labels"]
layout_mode = 0
offset_left = 499.0
offset_top = 117.0
offset_right = 875.0
offset_bottom = 257.0
scale = Vector2(0.5, 0.5)
text = "2"
script = ExtResource("3")
event = ExtResource("16")

[node name="currency_right" type="Label" parent="labels"]
layout_mode = 0
offset_left = 1279.0
offset_top = 118.0
offset_right = 1475.0
offset_bottom = 258.0
scale = Vector2(0.5, 0.5)
text = "2"
script = ExtResource("3")
event = ExtResource("15")

[node name="points_right" type="Label" parent="labels"]
layout_mode = 0
offset_left = 494.0
offset_top = 66.0
offset_right = 883.0
offset_bottom = 206.0
scale = Vector2(0.5, 0.5)
text = "Points: 0"
script = ExtResource("3")
event = ExtResource("17")

[node name="points_left" type="Label" parent="labels"]
layout_mode = 0
offset_left = 1234.0
offset_top = 66.0
offset_right = 1623.0
offset_bottom = 206.0
scale = Vector2(0.5, 0.5)
text = "Points: 0"
script = ExtResource("3")
event = ExtResource("18")

[node name="players" type="Node2D" parent="."]
script = ExtResource("9")

[node name="player_left" parent="players" instance=ExtResource("5")]
position = Vector2(646, 542)
input_definition = ExtResource("8")
_card_hand_path = NodePath("../../cards/card_hand_left")
health_changed_event = ExtResource("4")
currency_changed_event = ExtResource("16")
points_changed_event = ExtResource("18")
died_event = ExtResource("19")

[node name="player_right" parent="players" instance=ExtResource("5")]
position = Vector2(1309, 542)
input_definition = ExtResource("7")
_card_hand_path = NodePath("../../cards/card_hand_right")
health_changed_event = ExtResource("14")
currency_changed_event = ExtResource("15")
points_changed_event = ExtResource("17")
died_event = ExtResource("20")

[connection signal="timeout" from="match/prep_state/prep_timer" to="match/prep_state" method="_on_prep_timer_timeout"]
[connection signal="timeout" from="match/fighting_state/fighting_timer" to="match/fighting_state" method="_on_fight_timer_timeout"]
